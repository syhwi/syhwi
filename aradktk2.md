# KeyToKey設定2
***外部ツールのため自己責任で利用お願いします***

チャットの切替は手動でやるから、難しいことはしたくない方は以前のものを使ってください。
前のほうが使いやすかったとかであれば一部スクリプトを移植してみるのもアリです。

**前の[説明](https://github.com/syhwi/syhwi/blob/main/aradktk.md)との違い**

- プロファイルの切替がラグいのでなくした
- プロファイルの切替の代わりにマウス中ボタンに犠牲になってもらった
- チャットを除く入力欄を入力中は全角で入力することを前提にした処理に変更
- 半角/全角を押したときに連射モードをOFFに自動切替をできるようにした
- チャット欄を画像認識で検出し、チャットモードに切替をできるようにした
- (おまけ)EasyDash実装しました
   - サンプルのプロファイル[アラドデフォルトPAD1]をテンプレートに追加しました
     ※Hidhide環境で動作環境未実施

以下で犠牲キーと表記されているものは、プロファイルの代わりに切替ボタンとして設定されたキーを指します
犠牲キーはデフォルトではマウス中ボタンになっています

※☑はチェックボックスにチェックが入った状態、
☐はチェックボックスにチェックが入っていない状態を表します

  
## 前準備

KeyToKey公式からダウンロードして任意フォルダに展開

[[KeyToKey公式](https://keytokey-dev.net/)]

以下をダウンロードして展開した中身をKeyToKeyフォルダ(中身だけをexeと同じ階層)に上書きコピー

[[設定ファイル](https://drive.google.com/file/d/1PeKrkfkK9T_V7LA4ZCUgOztqX37O7IFA/view?usp=sharing)]

## 設定

1. 設定編集を開いて[割り当て設定（キー／マウス）]から連射不要なキーを右クリックして設定を解除
1. 画像認識の設定
    1. 設定編集を開いて画像認識画面に切り替える(赤枠部いずれかをクリック)
       ![image](https://github.com/syhwi/syhwi/assets/152038892/d03f2aff-092c-495a-9f39-ef60033b09ef)
       
    1. [chat_faceicon]をクリック
    1. [座標と範囲]→[座標と範囲を選択]をクリック
       ![image](https://github.com/syhwi/syhwi/assets/152038892/f46786ec-95a3-4733-8370-59fbbd6fccd6)
    1. 画面上に表示された赤枠をチャット時にでてくる顔のアイコンの部分に調整・移動させ、Enterを押す

       *範囲は広めで問題なし*
1. 画像認識テスト
    1. [スコアとテスト]→[画面を撮影してテストを実行]をクリック
    1. 小さいウィンドウが表示されるので[記録]をクリック後、1秒程度待って[記録を停止してテストをするをクリック]
    　 ![image](https://github.com/syhwi/syhwi/assets/152038892/2ad692d3-5c57-4340-83d7-d9939cb0f515)
    1. 新しいウィンドウが立ち上がるので[画像認識実行]をクリックし、赤い四角と1が表示されていれば成功
       ![image](https://github.com/syhwi/syhwi/assets/152038892/6ecbc2b0-ebe4-4b76-9f69-1151c954133f)
1. 画像認識テストが失敗した場合
    1. [テンプレート画像]→[撮影]をクリックし、表示された赤枠をチャットの顔のアイコンに重ねてEnterを押す
    2. 必要に応じて[画像を切り抜く]等を実行し、編集してください
       *画像はできるだけ小さめ推奨*

## その他

### 犠牲キー変更方法
- スクリプトの修正箇所
以下画像の「.MButton」の部分を修正してください。

ドットを入力すると候補が表示されます。
![image](https://github.com/syhwi/syhwi/assets/152038892/315d64cb-f609-4ed1-b780-c6f451573721)


- 割り当て設定側の修正箇所
1. 同時押し設定を変更して[MButtonが押されている時]をアクティブにした状態でゴミ箱をクリック
![image](https://github.com/syhwi/syhwi/assets/152038892/a342884b-dc12-40e8-aca2-303c7ad29306)
1. [+]をクリックした後に同時押しするボタンを押す
1. 犠牲キー押下後の各種キー設定を行う

    テンプレート時の設定の参考
   ![image](https://github.com/syhwi/syhwi/assets/152038892/3f3a99bd-e972-46c0-9e0e-894d64def845)

### EasyDash設定方法(PAD向け)
※キーボードでも設定可能ですが、左右同時押しすると歩いてしまいます。
 1. 設定編集を開いて[割り当て設定（コントローラー）]を選択
 1. 十字左キー、十字右キーをクリックして[マクロを割り当てる(押したとき、離したとき)]を選択
    ![image](https://github.com/syhwi/syhwi/assets/152038892/2dd16d58-9d6e-4df8-a42f-5413d0a3a7c8)
 1. EasyDashDownを選択する(押したとき)
    ![image](https://github.com/syhwi/syhwi/assets/152038892/ade778de-0838-474a-a258-786d94739332)
 1. keyに左なら[Keys.Left]、右なら[Keys.Right]を入力
 1. waittimeafterdownに[$waitTimeAfterDown]、waittimeafterupに[$waitTimeAfterUp]を入力し✓をクリック
 1. EasyDashUpを選択する(離したとき)
    ![image](https://github.com/syhwi/syhwi/assets/152038892/1cc421e5-88cb-4848-8c29-86556b75ed98)
 1. keyに左なら[Keys.Left]、右なら[Keys.Right]を入力
 1. waittimeafterdownに[$waitTimeAfterDown]を入力し✓をクリック

### IME変換モードチェックの待ち時間について
IMEの変換モードのチェックに待機時間を設定しています(Default:30ms)。

環境や体感によってもう少し短くしたいと感じたら

赤枠部をクリックし、グローバル変数[$IMEConversionModeWait]を変更して調整してください。

![image](https://github.com/syhwi/syhwi/assets/152038892/dfa99b76-5556-4bb4-b371-6aa143de90f7)

### 実装済拡張スクリプトの使い道

- クライアント画面外範囲処理

   犠牲キーが押された状態で画面外クリック時に外ウィンドウへ切替ができるようにする
- 押して離すEX

  基本実装の押して離すに加えて犠牲キーの状態を見てON/OFFができるようにしたもの
- チャット切替
 
  チャット欄が表示されているかを画像認識で判別し、犠牲キーの押す/離すを制御
- 入力欄切替
 
  IMEの入力モードを確認して、犠牲キーを押す/離すを制御
- デバッグ関連
  - 犠牲キーステータス出力

    犠牲キーの状態をコンソールに出力
  - 犠牲キーDOWN
    
    犠牲キーを押す
  - 犠牲キーUP
    
    犠牲キーを離す

質問は

- [kukuluのDM](https://live.erinn.biz/userdata.php?uid://2251607676@Twitter/)
- [X(旧Twitter)](https://twitter.com/_sysss)
から
